---
title: "Scanning Multiple Targets from Files and Lists"
description: "Discover how to automate large-scale screenshotting by scanning multiple websites or IPs using lists, files, and input batching. This guide explains file formats, input methods, and batching for reliable bulk scans."
---

# Scanning Multiple Targets from Files and Lists

Automate large-scale website or IP scanning by ingesting multiple targets from files, lists, or standard input. This guide walks you through configuring and running gowitness to efficiently handle bulk screenshotting jobs with flexible input formats, batching strategies, and command options.

---

## 1. Workflow Overview

### What This Guide Helps You Accomplish
You will learn how to scan multiple targets by providing lists or files as input sources—such as newline-separated URLs, CIDR ranges, Nmap XML exports, or Nessus files—and manage these batches reliably for large-scale automated screenshotting.

### Prerequisites
- Have gowitness installed and properly configured (see [Installing gowitness](https://docs.example.com/getting-started/getting-ready/installing-gowitness)).
- Basic familiarity with running gowitness commands.
- Preparation of your target files containing URLs, CIDRs, or scanner outputs.

### Expected Outcome
By following this guide, you will be able to run multi-target scans that:
- Accept targets from files or piped streams.
- Automatically normalize and filter URLs.
- Support concurrency for faster scans.
- Output results to specified storage formats (SQLite, JSONL, CSV).

### Time Estimate
About 15-30 minutes to set up your inputs, configure, and run your first multi-target scan.

### Difficulty Level
Intermediate — requires comfort with command-line interfaces and file operations.

---

## 2. Input Sources and Supported File Types

gowitness provides several subcommands under `gowitness scan` to handle different input types:

| Subcommand | Input Type                        | Description                             |
|------------|---------------------------------|-----------------------------------------|
| `file`     | Plain text files or stdin streams | Newline-separated URLs or domains        |
| `cidr`     | CIDR network blocks               | Scan IP address ranges, with optional ports |
| `nmap`     | XML files generated by Nmap       | Targets and ports parsed from nmap scans |
| `nessus`   | Nessus export files (not detailed here) | Import Nessus scan results for screenshotting |

### Key Notes on Input Formats
- When using file or stdin input, URLs should be newline-separated. Invalid URLs are ignored.
- For CIDRs, you can specify multiple network blocks and ports.
- Nmap XML supports granular port and service filtering.
- If a URL lacks a scheme (`http://` or `https://`), by default gowitness adds both; use flags to customize this.

---

## 3. Running a Scan from a File or List

### Step 1: Prepare Your Target File
Create a text file (e.g., `targets.txt`) with one URL or hostname per line:

```text
https://example.com
http://subdomain.test.local
example.org
```

### Step 2: Run the Scan Command
Use the `file` subcommand to scan these targets:

```bash
gowitness scan file -f targets.txt --write-db --write-jsonl
```

- `-f targets.txt` specifies the input file.
- `--write-db` saves metadata and screenshots info to the SQLite database.
- `--write-jsonl` outputs results in JSON Lines format.

### Step 3: Handling Input from Standard Input
You can pipe URLs from other commands or files:

```bash
cat urls.txt | gowitness scan file -f - --write-csv
```

The `-f -` flag tells gowitness to read from stdin.

### Step 4: Adjusting URL Schemes
By default, gowitness prepends `http://` and `https://` if no scheme is found.
- Use `--no-http` to disable prepending `http://`.
- Use `--no-https` to disable prepending `https://`.

For example:

```bash
gowitness scan file -f targets.txt --no-http --write-db
```

---

## 4. Scanning CIDR Ranges

### Step 1: Prepare Your CIDR List
Create a file (e.g., `cidrs.txt`) listing CIDR blocks:

```text
10.0.0.0/24
192.168.1.0/28
```

### Step 2: Scan CIDRs
Run the `cidr` subcommand:

```bash
gowitness scan cidr -f cidrs.txt --port 80 --port 443 --write-db
```

- The `--port` flags define which ports to include in URL candidates.
- You can specify multiple `--cidr` flags instead of a file.

### Additional CIDR Options
- `--no-http` and `--no-https` flags are supported as for `file` scans.
- The `--random` flag randomizes the scan order to reduce alerting risk.

---

## 5. Scanning Nmap XML Files

### Step 1: Export Nmap XML
Run Nmap with XML output enabled, e.g.:

```bash
nmap -oX scan.xml target-range
```

### Step 2: Run gowitness Scan

```bash
gowitness scan nmap -f scan.xml --write-db
```

### Port and Service Filtering
- Use `--port` to include only specific ports.
- Use `--exclude-port` or `--skip-port` to exclude ports.
- Use `--service` or `--service-contains` to filter by service name.
- Use `--open-only` to target only open ports.

For example:

```bash
gowitness scan nmap -f scan.xml --service http --port 80 --write-jsonl
```

### Hostname Inclusion
Enable hostname use in URL candidates with:

```bash
gowitness scan nmap -f scan.xml --hostnames
```

---

## 6. Command Options Overview

Control scan behavior using these options placed after the subcommand:

| Flag                           | Purpose                                         |
|--------------------------------|------------------------------------------------|
| `-t`, `--threads`              | Number of concurrent scan threads (default 6)  |
| `-T`, `--timeout`              | Timeout in seconds per target                    |
| `--delay`                     | Seconds delay before screenshot (default 3)    |
| `--screenshot-path`, `-s`     | Directory to save screenshots (default `./screenshots`) |
| `--screenshot-format`          | Screenshot format: `jpeg` or `png` (default jpeg) |
| `--write-db`                  | Store results in SQLite or other DB              |
| `--write-jsonl`               | Write results in JSON lines format                |
| `--write-csv`                 | Write results as CSV (limited columns)           |
| `--log-scan-errors`           | Enable logging of scan errors to stderr          |

See specific subcommand help for additional relevant flags.

---

## 7. Practical Example

Scan targets listed in a file, with multi-threading and JSONL output:

```bash
gowitness scan file -f targets.txt -t 20 --write-jsonl --write-db
```

Scan CIDRs with a large port list, no HTTP scheme added:

```bash
gowitness scan cidr -c 10.10.0.0/24 --ports-large --no-http --write-db
```

Scan an Nmap export, scanning only open HTTP services:

```bash
gowitness scan nmap -f nmap.xml --open-only --service http --write-db
```

---

## 8. Verify Scan Progress and Results

- Monitor logs for status codes, errors, and targets processed.
- Check the screenshot directory (default `./screenshots`) for saved images.
- Use reporting commands like `gowitness report list` to summarize saved scan results.
- Explore results via the web UI if available (requires SQLite output).

---

## 9. Troubleshooting Common Issues

<AccordionGroup title="Common Scanning Issues and Solutions">
<Accordion title="No Targets Found or Empty Output">
- Verify your input file path or stdin provides data.
- Ensure URLs are properly formatted or recognized.
- Add `--log-scan-errors` to see skipped invalid URLs.
</Accordion>
<Accordion title="Invalid URL Schemes or Missing Protocols">
- Use `--no-http` or `--no-https` flags to customize scheme addition.
- Confirm URLs include schemes if disabling auto-add.
</Accordion>
<Accordion title="Chrome Driver Errors or Timeout">
- Confirm Google Chrome or Chromium is installed.
- Check `--chrome-path` if a custom Chrome binary is needed.
- Adjust timeout settings with `--timeout`.
</Accordion>
<Accordion title="Performance Issues or Slow Scans">
- Increase concurrency with `--threads`.
- Reduce target count or filter inputs.
- Use the `--random` flag for randomized CIDR scans.
</Accordion>
<Accordion title="Output Files Not Generated or Updated">
- Ensure write flags like `--write-db`, `--write-jsonl`, or `--write-csv` are set.
- Verify permissions for output target directories or files.
</Accordion>
</AccordionGroup>

---

## 10. Best Practices

- Pre-validate your target list for correctness before running large scans.
- Use concurrency (`--threads`) wisely according to your system capacity.
- Enable output to persistent storage for later review via the reporting tools.
- Employ port and service filtering when scanning networks or large Nmap files.
- Use incremental or batched scans if files are extremely large.

---

## 11. Next Steps

- Explore the [Quickstart: Scan a Single Website](https://docs.example.com/guides/scanning-workflows/quickstart-single-scan) to understand single target scanning.
- Learn how to [Validate and View Results](https://docs.example.com/getting-started/your-first-scan/validating-results) after scanning.
- Dive into [Reporting and Managing Scan Results](https://docs.example.com/guides/reporting-and-results/generating-and-viewing-reports) for insights into generated data.
- Consider automation through the [gowitness Web API](https://docs.example.com/guides/advanced-usage-and-integration/web-api-integration) for non-interactive workflows.

---

## Appendix: Command Examples Summary

```bash
# Scan targets from a file, write to DB and JSONL
gowitness scan file -f targets.txt --write-db --write-jsonl

# Scan CIDR ranges with a medium port list
gowitness scan cidr -f cidrs.txt --ports-medium --write-db

# Scan Nmap XML, only HTTP services on port 80 and 443
gowitness scan nmap -f nmap.xml --service http --port 80 --port 443 --write-db

# Scan from stdin piping URLs, write CSV
cat urls.txt | gowitness scan file -f - --write-csv

# Scan single URL
gowitness scan single -u https://example.com --write-db
```

---

For comprehensive details on configuring output formats, see the [Understanding Output Formats guide](https://docs.example.com/getting-started/setup-and-configuration/understanding-output-formats).

---